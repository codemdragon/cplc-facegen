<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Face Prompt Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div class="container mx-auto p-4 max-w-6xl">
        <h1 class="text-2xl font-bold text-center mb-6">Face Prompt Builder</h1>
        
        <div class="flex flex-col md:flex-row gap-4">
            <!-- Left Sidebar -->
            <div class="w-full md:w-1/4 bg-white p-4 rounded-lg shadow">
                <h2 class="text-lg font-semibold mb-3">Facial Features</h2>
                <input 
                    type="text" 
                    id="featureSearch" 
                    placeholder="Search features..." 
                    class="w-full p-2 border border-gray-300 rounded mb-3"
                >
                <div class="h-96 overflow-y-auto">
                    <div id="featureList" class="space-y-2">
                        <!-- Features will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="w-full md:w-3/4 bg-white p-4 rounded-lg shadow">
                <h2 class="text-lg font-semibold mb-3">Feature Details</h2>
                
                <div id="featureEntries" class="space-y-4 mb-6">
                    <!-- Feature entry templates will be added here -->
                </div>
                
                <button 
                    id="addFeatureBtn" 
                    class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded mb-6"
                >
                    + Add Feature
                </button>
                
                <div class="mb-4">
                    <label class="block text-gray-700 font-medium mb-2">Combined Prompt</label>
                    <textarea 
                        id="combinedPrompt" 
                        rows="6" 
                        class="w-full p-3 border border-gray-300 rounded"
                    ></textarea>
                </div>
                
                <button 
                    id="copyPromptBtn" 
                    class="bg-green-500 hover:bg-green-600 text-white py-2 px-6 rounded"
                >
                    Copy Prompt
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Preset facial features
            const facialFeatures = [
                'Eyes', 'Eye Color', 'Face Shape', 'Skin Tone', 'Nose', 
                'Mouth', 'Lips', 'Hair Style', 'Hair Color', 'Eyebrows', 
                'Ears', 'Chin', 'Jawline', 'Facial Hair', 'Accessories', 
                'Scars/Tattoos/Birthmarks'
            ];
            
            // DOM elements
            const featureSearch = document.getElementById('featureSearch');
            const featureList = document.getElementById('featureList');
            const featureEntries = document.getElementById('featureEntries');
            const addFeatureBtn = document.getElementById('addFeatureBtn');
            const combinedPrompt = document.getElementById('combinedPrompt');
            const copyPromptBtn = document.getElementById('copyPromptBtn');
            
            // Initialize from local storage
            let featuresData = JSON.parse(localStorage.getItem('facePromptFeatures')) || [];
            
            // Populate feature list
            function populateFeatureList(filter = '') {
                featureList.innerHTML = '';
                const filteredFeatures = facialFeatures.filter(feature => 
                    feature.toLowerCase().includes(filter.toLowerCase())
                );
                
                filteredFeatures.forEach(feature => {
                    const div = document.createElement('div');
                    div.className = 'p-2 hover:bg-gray-100 rounded cursor-pointer';
                    div.textContent = feature;
                    div.addEventListener('click', () => {
                        addFeatureEntry(feature);
                    });
                    featureList.appendChild(div);
                });
            }
            
            // Add a new feature entry
            function addFeatureEntry(feature = '', details = '', saveToStorage = true) {
                const entryId = Date.now();
                
                const entryDiv = document.createElement('div');
                entryDiv.className = 'feature-entry p-3 border border-gray-200 rounded';
                entryDiv.dataset.id = entryId;
                
                entryDiv.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-1">Feature</label>
                            <input 
                                type="text" 
                                class="feature-input w-full p-2 border border-gray-300 rounded" 
                                value="${feature}" 
                                placeholder="e.g., Eyes"
                            >
                        </div>
                        <div>
                            <label class="block text-gray-700 text-sm font-medium mb-1">Describe changes or details</label>
                            <input 
                                type="text" 
                                class="details-input w-full p-2 border border-gray-300 rounded" 
                                value="${details}" 
                                placeholder="e.g., wider by 10%"
                            >
                        </div>
                    </div>
                    <button class="remove-entry mt-2 text-red-500 text-sm hover:text-red-700">
                        Remove
                    </button>
                `;
                
                featureEntries.appendChild(entryDiv);
                
                // Add event listeners
                entryDiv.querySelector('.feature-input').addEventListener('input', updateCombinedPrompt);
                entryDiv.querySelector('.details-input').addEventListener('input', updateCombinedPrompt);
                entryDiv.querySelector('.remove-entry').addEventListener('click', () => {
                    entryDiv.remove();
                    featuresData = featuresData.filter(item => item.id !== entryId);
                    saveFeatures();
                    updateCombinedPrompt();
                });
                
                if (saveToStorage) {
                    featuresData.push({
                        id: entryId,
                        feature,
                        details
                    });
                    saveFeatures();
                }
                
                updateCombinedPrompt();
            }
            
            // Update combined prompt
            function updateCombinedPrompt() {
                const entries = document.querySelectorAll('.feature-entry');
                let promptParts = [];
                
                entries.forEach(entry => {
                    const feature = entry.querySelector('.feature-input').value.trim();
                    const details = entry.querySelector('.details-input').value.trim();
                    
                    if (feature && details) {
                        promptParts.push(`${feature}: ${details}`);
                    }
                });
                
                combinedPrompt.value = promptParts.join(', ');
            }
            
            // Save features to local storage
            function saveFeatures() {
                const entries = document.querySelectorAll('.feature-entry');
                featuresData = [];
                
                entries.forEach(entry => {
                    featuresData.push({
                        id: entry.dataset.id,
                        feature: entry.querySelector('.feature-input').value,
                        details: entry.querySelector('.details-input').value
                    });
                });
                
                localStorage.setItem('facePromptFeatures', JSON.stringify(featuresData));
            }
            
            // Copy prompt to clipboard
            function copyPrompt() {
                const fullPrompt = `${combinedPrompt.value}\nEditing suspect image - apply above changes to current image version.`;
                navigator.clipboard.writeText(fullPrompt).then(() => {
                    alert('Prompt copied to clipboard!');
                });
            }
            
            // Event listeners
            featureSearch.addEventListener('input', (e) => {
                populateFeatureList(e.target.value);
            });
            
            addFeatureBtn.addEventListener('click', () => {
                addFeatureEntry();
            });
            
            combinedPrompt.addEventListener('input', saveFeatures);
            
            copyPromptBtn.addEventListener('click', copyPrompt);
            
            // Initialize
            populateFeatureList();
            
            // Load saved features
            if (featuresData.length > 0) {
                featuresData.forEach(feature => {
                    addFeatureEntry(feature.feature, feature.details, false);
                });
                updateCombinedPrompt();
            } else {
                // Add one empty entry by default
                addFeatureEntry();
            }
        });
    </script>
</body>
</html>
